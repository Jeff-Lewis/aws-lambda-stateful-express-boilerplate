<!DOCTYPE html>
<html>

<head>
  <title>Express Lambda</title>
  <meta content="{{csrfToken}}" name="csrf-token" />
</head>

<body>
  {{{body}}}
  <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script>
    //FIXME scripts should be moved to a js file and served as static file

    // Injects the CSRF token as header in every ajax request for this domain
    jQuery.ajaxPrefilter(function(options, _, xhr) {
      if (!xhr.crossDomain) {
        var securityToken = $('meta[name="csrf-token"]').attr('content');
        xhr.setRequestHeader('X-CSRF-Token', securityToken);
      }
    });

    function normalizeUrl(url) {
      var path = window.location.pathname;
      var lastChar = path.substr(-1);
      if (lastChar != '/') {
        path = path + '/';
      }
      if (url.charAt(0) == '/') {
        url = url.substr(1);
      }
      return path + url;
    }
  </script>
</body>

</html>
